<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Throwing Shade | Urban Shade Analysis</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #000000;
      color: #ffffff;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }
    
    /* Landing Section */
    .hero-section {
      position: relative;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    
    #sunRaysCanvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 0;
      background: #1a1a1a;
    }
    
    .hero-content {
      position: relative;
      z-index: 1;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 0;
    }
    
    .header {
      padding: 40px 60px 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }
    
    .logo {
      font-size: 28px;
      font-weight: 600;
      color: #95C11F;
      letter-spacing: -0.02em;
    }
    
    .header-info {
      text-align: right;
      color: #cccccc;
      font-size: 14px;
      font-weight: 300;
      line-height: 1.4;
    }
    
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 0 60px;
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
    }
    
    .title {
      font-size: clamp(48px, 6vw, 84px);
      font-weight: 300;
      color: #ffffff;
      letter-spacing: -0.03em;
      line-height: 0.95;
      margin-bottom: 24px;
    }
    
    .subtitle {
      font-size: 20px;
      font-weight: 400;
      color: #95C11F;
      margin-bottom: 32px;
      max-width: 600px;
    }
    
    .description {
      font-size: 16px;
      font-weight: 300;
      color: #cccccc;
      max-width: 500px;
      line-height: 1.7;
      margin-bottom: 48px;
    }
    
    .scroll-indicator {
      position: absolute;
      bottom: 40px;
      left: 60px;
      display: flex;
      align-items: center;
      gap: 12px;
      color: #888888;
      font-size: 12px;
      font-weight: 300;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    
    .scroll-indicator:hover {
      color: #95C11F;
    }
    
    .scroll-arrow {
      width: 1px;
      height: 40px;
      background: #95C11F;
      position: relative;
      overflow: hidden;
    }
    
    .scroll-arrow::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 8px;
      background: #95C11F;
      animation: scroll-pulse 2s infinite ease-in-out;
    }
    
    @keyframes scroll-pulse {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(32px); }
    }
    
    /* Map Section */
    .map-section {
      min-height: 100vh;
      background: #000000;
      position: relative;
    }
    
    .map-header {
      background: #000000;
      border-bottom: 1px solid #333333;
      padding: 20px 60px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    
    .map-title {
      font-size: 18px;
      font-weight: 500;
      color: #ffffff;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .back-to-top {
      color: #888888;
      text-decoration: none;
      font-size: 13px;
      font-weight: 300;
      border: 1px solid #333333;
      padding: 8px 16px;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.02em;
    }
    
    .back-to-top:hover {
      border-color: #95C11F;
      color: #95C11F;
    }
    
    .map-container {
      height: calc(100vh - 81px);
      position: relative;
    }
    
    #map {
      height: 100%;
      width: 100%;
    }
    
    /* Map Controls */
    .map-controls {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .control-panel {
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      border: 1px solid #333333;
      padding: 16px;
      min-width: 280px;
      font-size: 13px;
      color: #cccccc;
    }
    
    .control-title {
      font-weight: 500;
      color: #95C11F;
      margin-bottom: 12px;
      font-size: 14px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    
    .legend-color {
      width: 16px;
      height: 12px;
      border: 1px solid #555555;
    }
    
    /* Info Panel */
    .info-panel {
      position: absolute;
      bottom: 20px;
      left: 20px;
      z-index: 1000;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      border: 1px solid #333333;
      padding: 20px;
      max-width: 400px;
      min-width: 300px;
      transform: translateY(100%);
      opacity: 0;
      transition: all 0.3s ease;
      font-size: 13px;
      line-height: 1.5;
    }
    
    .info-panel.active {
      transform: translateY(0);
      opacity: 1;
    }
    
    .info-title {
      font-size: 16px;
      font-weight: 500;
      color: #95C11F;
      margin-bottom: 12px;
    }
    
    .info-stats {
      color: #cccccc;
      margin-bottom: 16px;
    }
    
    .info-close {
      position: absolute;
      top: 16px;
      right: 16px;
      background: none;
      border: none;
      color: #888888;
      font-size: 18px;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    
    .info-close:hover {
      color: #95C11F;
    }
    
    /* Loading Indicator */
    .loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1001;
      background: rgba(0, 0, 0, 0.9);
      padding: 20px 30px;
      border: 1px solid #333333;
      color: #95C11F;
      font-size: 14px;
      font-weight: 300;
      opacity: 0;
      transition: opacity 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    .loading.show {
      opacity: 1;
    }
    
    .loading::after {
      content: '';
      display: inline-block;
      width: 12px;
      height: 12px;
      border: 2px solid transparent;
      border-top: 2px solid #95C11F;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-left: 8px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Leaflet customization */
    .leaflet-tile {
      filter: brightness(0.8) contrast(1.1);
    }
    
    .custom-tooltip {
      background: rgba(0, 0, 0, 0.9) !important;
      border: 1px solid #333333 !important;
      color: #ffffff !important;
      font-family: 'Inter', sans-serif !important;
      font-size: 12px !important;
      line-height: 1.4 !important;
      padding: 8px 12px !important;
      backdrop-filter: blur(5px);
    }
    
    .custom-tooltip::before {
      border-top-color: #333333 !important;
    }
    
    .leaflet-popup-content-wrapper {
      background: rgba(0, 0, 0, 0.95) !important;
      color: #ffffff !important;
      border: 1px solid #333333 !important;
      backdrop-filter: blur(10px);
    }
    
    .leaflet-popup-tip {
      background: rgba(0, 0, 0, 0.95) !important;
      border: 1px solid #333333 !important;
    }
    
    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }
    
    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .title, .subtitle, .description {
      animation: fadeInUp 1s ease-out forwards;
    }
    
    .subtitle { animation-delay: 0.2s; }
    .description { animation-delay: 0.4s; }
    .scroll-indicator { animation-delay: 0.8s; }
    
    /* Responsive */
    @media (max-width: 1024px) {
      .header, .main-content, .map-header {
        padding-left: 40px;
        padding-right: 40px;
      }
      
      .map-controls, .info-panel {
        right: 15px;
        left: 15px;
        max-width: none;
        min-width: auto;
      }
      
      .scroll-indicator {
        left: 40px;
      }
    }
    
    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
      }
      
      .header-info {
        text-align: left;
      }
      
      .map-header {
        flex-direction: column;
        gap: 12px;
        align-items: flex-start;
        padding: 16px 24px;
      }
      
      .control-panel {
        padding: 12px;
        min-width: auto;
      }
      
      .scroll-indicator {
        left: 24px;
      }
      
      .header, .main-content, .map-header {
        padding-left: 24px;
        padding-right: 24px;
      }
    }
  </style>
</head>
<body>
  <!-- Hero Section with Animation -->
  <section class="hero-section" id="hero">
    <canvas id="sunRaysCanvas"></canvas>
    
    <div class="hero-content">
      <header class="header">
        <div class="logo">Throwing Shade</div>
        <div class="header-info">
          MIT Senseable City Lab<br>
          TUD 3D Geoinformation
        </div>
      </header>
      
      <main class="main-content">
        <h1 class="title">(Slim Shady)</h1>
        <p class="subtitle">
          Making shade visible<br>
          and actionable
        </p>
        <p class="description">
            This project reveals where Amsterdam’s sidewalks<br>
            stay cool, and where they don’t. By combining high-res<br>
            solar simulations, street tree data, and building models,<br>
            we create a living map of shade availability.<br>
            <br>
            The purpose? To help planners, designers, and communities<br>
            make strategic decisions on planting, design, and climate<br>
            resilience — starting right here, right now.
          </p>
      </main>
      
      <div class="scroll-indicator" onclick="scrollToMap()">
        <div class="scroll-arrow"></div>
        <span>Explore Data</span>
      </div>
    </div>
  </section>

  <!-- Map Section -->
  <section class="map-section" id="map-section">
    <div class="map-header">
      <div class="map-title">
        <span>(Slim) Shady</span>
        <span style="color: #666666;">|</span>
        <span style="color: #95C11F; font-weight: 300;">Interactive Shade Analysis of Amsterdam</span>
      </div>
      <a href="#hero" class="back-to-top">↑ Back to Top</a>
    </div>
    
    <div class="map-container">
      <div id="map"></div>
      
      <!-- Map Controls -->
      <div class="map-controls">
        <div class="control-panel">
          <div class="control-title">Shade Index Legend</div>
          <div class="legend-item">
            <div class="legend-color" style="background: #B71C1C;"></div>
            <span>No shade (0.0)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #FF5722;"></div>
            <span>Low shade (0.2)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #FF9800;"></div>
            <span>Moderate shade (0.4)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #FFC107;"></div>
            <span>Good shade (0.6)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #95C11F;"></div>
            <span>High shade (0.8)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #5B7026;"></div>
            <span>Full shade (1.0)</span>
          </div>
        </div>
      </div>
      
      <!-- Info Panel -->
      <div class="info-panel" id="infoPanel">
        <button class="info-close" onclick="hideInfoPanel()">×</button>
        <div class="info-title">Neighborhood Details</div>
        <div class="info-stats" id="buurtInfo">
          Click on a neighborhood to view detailed shade analysis...
        </div>
      </div>
      
      <!-- Loading Indicator -->
      <div class="loading" id="loadingIndicator">
        Loading data
      </div>
    </div>
  </section>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="sunrays.js"></script>
  <script src="map.js"></script>
  
  <script>
    // Smooth scroll to map section
    function scrollToMap() {
      document.getElementById('map-section').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
      });
    }
    
    // Handle canvas resizing when scrolling
    let isHeroVisible = true;
    
    function handleScroll() {
      const heroSection = document.getElementById('hero');
      const heroRect = heroSection.getBoundingClientRect();
      const isCurrentlyVisible = heroRect.bottom > 0 && heroRect.top < window.innerHeight;
      
      if (isCurrentlyVisible !== isHeroVisible) {
        isHeroVisible = isCurrentlyVisible;
        
        // Resize canvas when hero visibility changes
        if (window.resizeCanvas) {
          window.resizeCanvas();
        }
      }
    }
    
    // Optimize scroll listening
    let scrollTimeout;
    window.addEventListener('scroll', () => {
      if (scrollTimeout) {
        clearTimeout(scrollTimeout);
      }
      scrollTimeout = setTimeout(handleScroll, 100);
    });
    
    // Initialize map when map section becomes visible
    let mapInitialized = false;
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting && !mapInitialized) {
          mapInitialized = true;
          // Initialize map here - the map.js will handle this
        }
      });
    }, { threshold: 0.1 });
    
    observer.observe(document.getElementById('map-section'));
  </script>
</body>
</html>
